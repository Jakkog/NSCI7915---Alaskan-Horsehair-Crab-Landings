cpueMean <- mean(maleData[,"cpue"], na.rm = TRUE),
cpueSD <- sd(maleData[,"cpue"], na.rm = TRUE),
depthMean <- mean(maleData[,"bottom_depth"], na.rm = TRUE),
surfacetempMean <- mean(maleData[,"surface_temperature"], na.rm = TRUE),
bottomtempMean <- mean(maleData[,"bottom_temperature"], na.rm = TRUE)
)
maleData %>%
group_by(maleData[,"year"]) %>%
summarise(
cpueMean <- mean(maleData[,"cpue"], na.rm = TRUE),
cpueSD <- sd(maleData[,"cpue"], na.rm = TRUE),
depthMean <- mean(maleData[,"bottom_depth"], na.rm = TRUE),
surfacetempMean <- mean(maleData[,"surface_temperature"], na.rm = TRUE),
bottomtempMean <- mean(maleData[,"bottom_temperature"], na.rm = TRUE)
)
byYear <- maleData %>%
group_by(maleData[,"year"]) %>%
summarise(
cpueMean <- mean(maleData[,"cpue"], na.rm = TRUE),
cpueSD <- sd(maleData[,"cpue"], na.rm = TRUE),
depthMean <- mean(maleData[,"bottom_depth"], na.rm = TRUE),
surfacetempMean <- mean(maleData[,"surface_temperature"], na.rm = TRUE),
bottomtempMean <- mean(maleData[,"bottom_temperature"], na.rm = TRUE)
)
byYear
View(byYear)
plot(maleData[,"surface_temperature"],maleData[,"year"])
plot(maleData[,"year"], maleData[,"year"])
plot(maleData[,"year"], maleData[,"surface_temperature"])
abline(0,0)
plot(maleData[,"year"], maleData[,"surface_temperature"])
plot(crabData[,"year"],crabData[,"surface_temperature"])
plot(crabData[,"year"],crabData[,mean("surface_temperature")])
surfacetempAvgPerYear %>%
group_by(crabData[,"year"]) %>%
summarise(avgSTempPerYear = mean(crabData[,"surface_temperature"], na.rm = TRUE))
surfacetempAvgPerYear <- crabData %>%
group_by(crabData[,"year"]) %>%
summarise(avgSTempPerYear = mean(crabData[,"surface_temperature"], na.rm = TRUE))
surfacetempAvgPerYear
surfacetempAvgPerYear <- crabData %>%
group_by(crabData$year) %>%
summarise(avgSTempPerYear = mean(crabData$surface_temperature, na.rm = TRUE))
surfacetempAvgPerYear
crabData$year <- as.integer(crabData$year)
surfacetempAvgPerYear <- crabData %>%
group_by(crabData$year) %>%
summarise(avgSTempPerYear = mean(crabData$surface_temperature, na.rm = TRUE))
surfacetempAvgPerYear
str(crabData$year)
surfacetempAvgPerYear <- crabData %>%
group_by(year) %>%
summarise(avgSTempPerYear = mean(surface_temperature, na.rm = TRUE))
surfacetempAvgPerYear
plot(surfacetempAvgPerYear)
plot(line(surfacetempAvgPerYear))
abline
abline(0,0)
plot(surfacetempAvgPerYear)
abline(0,0)
plot(diff(surfacetempAvgPerYear))
plot(scale(surfacetempAvgPerYear))
abline(0,0)
byYear <- maleData %>%
group_by(maleData[,"year"]) %>%
summarise(
cpueMean <- mean(maleData[,"cpue"], na.rm = TRUE),
cpueSD <- sd(maleData[,"cpue"], na.rm = TRUE),
depthMean <- mean(maleData[,"bottom_depth"], na.rm = TRUE),
surfacetempMean <- mean(maleData[,"surface_temperature"], na.rm = TRUE),
bottomtempMean <- mean(maleData[,"bottom_temperature"], na.rm = TRUE)
)
byYear
byYear <- maleData %>%
group_by(year) %>%
summarise(
cpueMean <- mean(cpue, na.rm = TRUE),
cpueSD <- sd(cpue, na.rm = TRUE),
depthMean <- mean(bottom_depth, na.rm = TRUE),
surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
byYear
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`)
plot(byYear$year, byYear$cpueMean)
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`)
byYear
View(byYear)
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`)
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
abline()
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
abline()
abline(lm(byYear$year ~ byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`), col = "red")
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
abline(lm(byYear$year ~ byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`), col = "red")
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
plot(crabData[,"year"],crabData[,mean("surface_temperature")])
crabData$year <- as.integer(crabData$year)
surfacetempAvgPerYear <- crabData %>%
group_by(year) %>%
summarise(avgSTempPerYear = mean(surface_temperature, na.rm = TRUE))
surfacetempAvgPerYear
plot(surfacetempAvgPerYear)
plot(scale(surfacetempAvgPerYear))
abline(0,0)
plot(surfacetempAvgPerYear)
surfacetempAvgPerYear
plot(surfacetempAvgPerYear)
plot(scale(surfacetempAvgPerYear))
plot(surfacetempAvgPerYear)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
byYear <- crabData %>%
group_by(year) %>%
summarise(
cpueMean <- mean(cpue, na.rm = TRUE),
cpueSD <- sd(cpue, na.rm = TRUE),
depthMean <- mean(bottom_depth, na.rm = TRUE),
surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
byYear
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(scale(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`))
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
summary(maleData[7:11])
summary(femaleData[7:11])
avgCatchYear %>% forecast(h=10) %>% autoplot()
f.avgCatchYear %>% forecast(h=10) %>% autoplot()
arima.avgCY <- auto.arima(avgCatchYear) # used to model future values
arima.f.avgCY <- auto.arima(f.avgCatchYear)
arima.avgCY %>% forecast(h=10) %>% autoplot()
arima.f.avgCY %>% forecast(h=10) %>% autoplot()
install.packages("maps")
library(maps)
map(projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
install.packages("mapproj")
library(mapproj)
(projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(regions = "alaska", projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
points(crabData[,"latitude"],crabData[,"longitude"],pch=21,col='grey50',bg='gold',cex=0.7)
map(projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
points(crabData[,"latitude"],crabData[,"longitude"],pch=21,col='grey50',bg='gold',cex=0.7)
map(database = "world", regions = "alaska:west", projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
mapsnames <- map("world", plot = FALSE)
unique(mapsnames$names)
head(unique(mapsnames$names))
unique(mapsnames$names)
tail(unique(mapsnames$names))
View(mapsnames)
df.mapnames <- data.frame(mapsnames$names)
View(df.mapnames)
map(database = "world", regions = "USA:Alaska", projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = "USA", projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map("north america", projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico", "Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
points(crabData[,"latitude"],crabData[,"longitude"],pch=21,col='grey50',bg='gold',cex=0.7)
points(crabData$latitude,crabData$long,pch=21,col='grey50',bg='gold',cex=0.7)
points(crabData$latitude,crabData$long,col='grey50',bg='gold',cex=0.7)
points(crabData$latitude,crabData$longitude,pch=21,col='grey50',bg='gold',cex=7)
points(crabData$latitude,crabData$longitude,pch=21,col='grey50',bg='gold',cex=0.7)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia", "!Hawaii"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia", "!hawaii"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia", "!USA:Hawaii"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia", !"USA:Hawaii"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
points(crabData$latitude,crabData$longitude,pch=21,col='grey50',bg='gold',cex=0.7)
plot(maleData[,"latitude"],maleData[,"haul"])
plot(maleData[,"longitude"],maleData[,"haul"])
hist(maleData[,"haul"])
plot(femaleData[,"latitude"],femaleData[,"haul"])
plot(femaleData[,"longitude"],femaleData[,"haul"])
plot(maleData[,"longitude"],maleData[,"haul"])
plot(femaleData[,"longitude"],femaleData[,"haul"])
plot(maleData[,"longitude"],maleData[,"haul"])
plot(femaleData[,"longitude"],femaleData[,"haul"])
plot(maleData[,"longitude"],maleData[,"haul"])
plot(maleData[,"year"],maleData[,"haul"])
plot(femaleData[,"year"],femaleData[,"haul"])
plot(maleData[,"year"],maleData[,"haul"])
plot(femaleData[,"year"],femaleData[,"haul"])
plot(maleData[,"year"],maleData[,"haul"])
plot(maleData[,"bottom_depth"],maleData[,"haul"])
plot(femaleData[,"bottom_depth"],femaleData[,"haul"])
plot(maleData[,"surface_temperature"],maleData[,"haul"])
plot(femaleData[,"surface_temperature"],femaleData[,"haul"])
plot(femaleData[,"surface_temperature"],femaleData[,"haul"])
plot(maleData[,"longitude"], maleData[,"latitude"],cex=log(maleData[,"haul"])/5,col=hsv(h=pnorm(scale(log(maleData[,"haul"])))))
plot(femaleData[,"longitude"],femaleData[,"latitude"],cex=log(femaleData[,"haul"])/5,col=hsv(h=pnorm(scale(log(femaleData[,"haul"])))))
summary(lm(log(maleData[,"haul"]) ~ maleData[,"latitude"] + maleData[,"longitude"]))
crabResid <- resid(lm(log(maleData[,"haul"]) ~ maleData[,"latitude"] + maleData[,"longitude"]))
plot(crabResid,maleData[,"year"])
hist(crabResid, breaks = 30) # not normal dist
plot(crabResid, maleData[,"cpue"], log="y") # not normal, not a consistant pattern
summary(lm(log(femaleData[,"haul"]) ~ femaleData[,"latitude"] + femaleData[,"longitude"]))
f.crabResid <- resid(lm(log(femaleData[,"haul"]) ~ femaleData[,"latitude"] + femaleData[,"longitude"]))
plot(f.crabResid,femaleData[,"year"])
hist(f.crabResid, breaks = 30) # not normal? much closer than male
plot(f.crabResid,femaleData[,"year"])
summary(lm(log(femaleData[,"haul"]) ~ femaleData[,"latitude"] + femaleData[,"longitude"]))
f.crabResid <- resid(lm(log(femaleData[,"haul"]) ~ femaleData[,"latitude"] + femaleData[,"longitude"]))
plot(f.crabResid,femaleData[,"year"])
hist(f.crabResid, breaks = 30) # not normal? much closer than male
plot(f.crabResid, femaleData[,"cpue"],log = "y")
summary(lm(log(maleData[,"haul"]) ~ maleData[,"latitude"] + maleData[,"longitude"]))
crabResid <- resid(lm(log(maleData[,"haul"]) ~ maleData[,"latitude"] + maleData[,"longitude"]))
plot(crabResid,maleData[,"year"])
hist(crabResid, breaks = 30) # not normal dist
plot(crabResid, maleData[,"cpue"], log="y") # not normal, not a consistant pattern
hist(crabResid, breaks = 30) # not normal dist
hist(f.crabResid, breaks = 30, add = T, col = hsv(0.1, alpha = 0.3), border = 'deeppink') # not normal? much closer than male
avgCatchYear <- array()
for(i in unique(maleData[,"year"]))
avgCatchYear[i] = mean(log(maleData[maleData[,"year"]==i,"haul"]))
avgCatchYear = na.omit(avgCatchYear)
f.avgCatchYear <- array()
for(i in unique(femaleData[,"year"]))
f.avgCatchYear[i] = mean(log(femaleData[femaleData[,"year"]==i,"haul"]))
f.avgCatchYear = na.omit(f.avgCatchYear)
# time series plot
crabYears <- 1980:2018
plot(crabYears,avgCatchYear)
plot(crabYears,f.avgCatchYear)
acf(avgCatchYear)
acf(f.avgCatchYear)
plot(1980:2017, diff(avgCatchYear))
abline(0,0)
acf(diff(avgCatchYear)) # negative correlation, increases followed by decreases
plot(1980:2017, diff(f.avgCatchYear))
abline(0,0)
acf(diff(f.avgCatchYear))
auto.arima(avgCatchYear) # used to model future values
auto.arima(f.avgCatchYear)
plot(resid(auto.arima(avgCatchYear)))
abline(0,0)
plot(resid(auto.arima(f.avgCatchYear)))
abline(0,0)
avgCatchYear %>% forecast(h=10) %>% autoplot()
f.avgCatchYear %>% forecast(h=10) %>% autoplot()
arima.avgCY <- auto.arima(avgCatchYear) # used to model future values
arima.f.avgCY <- auto.arima(f.avgCatchYear)
arima.avgCY %>% forecast(h=10) %>% autoplot()
arima.f.avgCY %>% forecast(h=10) %>% autoplot()
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
points(crabData$latitude,crabData$longitude,pch=21,col='grey50',bg='gold',cex=0.7)
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
byYear <- crabData %>%
group_by(year) %>%
summarise(
haulMean <- mean(haul, na.rm = TRUE),
haulSD <- sd(haul, na.rm = TRUE),
cpueMean <- mean(cpue, na.rm = TRUE),
cpueSD <- sd(cpue, na.rm = TRUE),
depthMean <- mean(bottom_depth, na.rm = TRUE),
surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
byYear
plot(byYear$year, byYear$`haulMean <- mean(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`haulMean <- mean(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`haulMean <- mean(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`haulSD <- sd(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`haulMean <- mean(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`haulSD <- sd(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
summary(maleData[7:11])
summary(femaleData[7:11])
malebyYear <- maleData %>%
group_by(year) %>%
summarise(
m.haulMean <- mean(haul, na.rm = TRUE),
m.haulSD <- sd(haul, na.rm = TRUE),
m.cpueMean <- mean(cpue, na.rm = TRUE),
m.cpueSD <- sd(cpue, na.rm = TRUE),
m.depthMean <- mean(bottom_depth, na.rm = TRUE),
m.surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
m.bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
malebyYear
plot(byYear$year, byYear$`m.haulMean <- mean(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`m.haulSD <- sd(haul, na.rm = TRUE)`)
malebyYear <- maleData %>%
group_by(year) %>%
summarise(
m.haulMean <- mean(haul, na.rm = TRUE),
m.haulSD <- sd(haul, na.rm = TRUE),
m.cpueMean <- mean(cpue, na.rm = TRUE),
m.cpueSD <- sd(cpue, na.rm = TRUE),
m.depthMean <- mean(bottom_depth, na.rm = TRUE),
m.surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
m.bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
malebyYear
plot(malebyYear$year, malebyYear$`m.haulMean <- mean(haul, na.rm = TRUE)`)
plot(malebyYear$year, malebyYear$`m.haulSD <- sd(haul, na.rm = TRUE)`)
plot(malebyYear$year, malebyYear$`m.cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(malebyYear$year, malebyYear$`m.cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(malebyYear$year, malebyYear$`m.depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(malebyYear$year, malebyYear$`m.surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(malebyYear$year, malebyYear$`m.bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
femalebyYear <- femaleData %>%
group_by(year) %>%
summarise(
f.haulMean <- mean(haul, na.rm = TRUE),
f.haulSD <- sd(haul, na.rm = TRUE),
f.cpueMean <- mean(cpue, na.rm = TRUE),
f.cpueSD <- sd(cpue, na.rm = TRUE),
f.depthMean <- mean(bottom_depth, na.rm = TRUE),
f.surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
f.bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
malebyYear
plot(femalebyYear$year, femalebyYear$`m.haulMean <- mean(haul, na.rm = TRUE)`)
femalebyYear <- femaleData %>%
group_by(year) %>%
summarise(
f.haulMean <- mean(haul, na.rm = TRUE),
f.haulSD <- sd(haul, na.rm = TRUE),
f.cpueMean <- mean(cpue, na.rm = TRUE),
f.cpueSD <- sd(cpue, na.rm = TRUE),
f.depthMean <- mean(bottom_depth, na.rm = TRUE),
f.surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
f.bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
malebyYear
plot(femalebyYear$year, femalebyYear$`f.haulMean <- mean(haul, na.rm = TRUE)`)
plot(femalebyYear$year, femalebyYear$`f.haulSD <- sd(haul, na.rm = TRUE)`)
plot(femalebyYear$year, femalebyYear$`f.cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(femalebyYear$year, femalebyYear$`f.cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(femalebyYear$year, femalebyYear$`f.depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(femalebyYear$year, femalebyYear$`f.surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(femalebyYear$year, femalebyYear$`f.bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
plot(malebyYear$year, malebyYear$`m.depthMean <- mean(bottom_depth, na.rm = TRUE)`)
femalebyYear <- femaleData %>%
group_by(year) %>%
summarise(
f.haulMean <- mean(haul, na.rm = TRUE),
f.haulSD <- sd(haul, na.rm = TRUE),
f.cpueMean <- mean(cpue, na.rm = TRUE),
f.cpueSD <- sd(cpue, na.rm = TRUE),
f.depthMean <- mean(bottom_depth, na.rm = TRUE),
f.surfacetempMean <- mean(surface_temperature, na.rm = TRUE),
f.bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)
)
plot(femalebyYear$year, femalebyYear$`f.depthMean <- mean(bottom_depth, na.rm = TRUE)`)
summary(maleData[7:11])
summary(femaleData[7:11])
setwd("C:/Users/ltger/OneDrive/Desktop/datasets/Kaggle/Alaskan_HorsehairCrabLandings")
plot(byYear$year, byYear$`haulMean <- mean(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`haulSD <- sd(haul, na.rm = TRUE)`)
plot(byYear$year, byYear$`cpueMean <- mean(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`) # 642 cpue = >40k
plot(byYear$year, byYear$`cpueSD <- sd(cpue, na.rm = TRUE)`, log = "y") # 642 cpue = >40k
plot(byYear$year, byYear$`depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(byYear$year, byYear$`surfacetempMean <- mean(surface_temperature, na.rm = TRUE)`)
plot(byYear$year, byYear$`bottomtempMean <- mean(bottom_temperature, na.rm = TRUE)`)
plot(femalebyYear$year, femalebyYear$`f.depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(malebyYear$year, malebyYear$`m.depthMean <- mean(bottom_depth, na.rm = TRUE)`)
plot(maleData[,"latitude"],maleData[,"haul"])
plot(maleData[,"longitude"],maleData[,"haul"])
hist(maleData[,"haul"])
plot(femaleData[,"latitude"],femaleData[,"haul"])
plot(femaleData[,"longitude"],femaleData[,"haul"])
hist(femaleData[,"haul"])
plot(maleData[,"year"],maleData[,"haul"])
plot(femaleData[,"year"],femaleData[,"haul"])
plot(maleData[,"bottom_depth"],maleData[,"haul"])
plot(femaleData[,"bottom_depth"],femaleData[,"haul"])
plot(maleData[,"surface_temperature"],maleData[,"haul"])
plot(femaleData[,"surface_temperature"],femaleData[,"haul"])
crabData$year <- as.integer(crabData$year)
surfacetempAvgPerYear <- crabData %>%
group_by(year) %>%
summarise(avgSTempPerYear = mean(surface_temperature, na.rm = TRUE))
surfacetempAvgPerYear
plot(surfacetempAvgPerYear)
plot(scale(surfacetempAvgPerYear))
abline(0,0)
plot(maleData[,"longitude"], maleData[,"latitude"],cex=log(maleData[,"haul"])/5,col=hsv(h=pnorm(scale(log(maleData[,"haul"])))))
plot(femaleData[,"longitude"],femaleData[,"latitude"],cex=log(femaleData[,"haul"])/5,col=hsv(h=pnorm(scale(log(femaleData[,"haul"])))))
summary(lm(log(maleData[,"haul"]) ~ maleData[,"latitude"] + maleData[,"longitude"]))
crabResid <- resid(lm(log(maleData[,"haul"]) ~ maleData[,"latitude"] + maleData[,"longitude"]))
plot(crabResid,maleData[,"year"])
hist(crabResid, breaks = 30) # not normal dist
plot(crabResid, maleData[,"cpue"], log="y") # not normal, not a consistant pattern
summary(lm(log(femaleData[,"haul"]) ~ femaleData[,"latitude"] + femaleData[,"longitude"]))
f.crabResid <- resid(lm(log(femaleData[,"haul"]) ~ femaleData[,"latitude"] + femaleData[,"longitude"]))
plot(f.crabResid,femaleData[,"year"])
hist(f.crabResid, breaks = 30, add = T, col = hsv(0.1, alpha = 0.3), border = 'deeppink') # not normal? much closer than male
plot(f.crabResid, femaleData[,"cpue"],log = "y")
hist(f.crabResid, breaks = 30, add = T, col = hsv(0.1, alpha = 0.3), border = 'deeppink') # not normal? much closer than male
hist(crabResid, breaks = 30) # not normal dist
hist(f.crabResid, breaks = 30, add = T, col = hsv(0.1, alpha = 0.3), border = 'deeppink') # not normal? much closer than male
hist(f.crabResid, breaks = 30) # not normal? much closer than male
avgCatchYear <- array()
for(i in unique(maleData[,"year"]))
avgCatchYear[i] = mean(log(maleData[maleData[,"year"]==i,"haul"]))
avgCatchYear = na.omit(avgCatchYear)
f.avgCatchYear <- array()
for(i in unique(femaleData[,"year"]))
f.avgCatchYear[i] = mean(log(femaleData[femaleData[,"year"]==i,"haul"]))
f.avgCatchYear = na.omit(f.avgCatchYear)
# time series plot
crabYears <- 1980:2018
plot(crabYears,avgCatchYear)
plot(crabYears,f.avgCatchYear)
acf(avgCatchYear)
acf(f.avgCatchYear)
plot(1980:2017, diff(avgCatchYear))
abline(0,0)
acf(diff(avgCatchYear)) # negative correlation, increases followed by decreases
plot(1980:2017, diff(f.avgCatchYear))
abline(0,0)
acf(diff(f.avgCatchYear))
auto.arima(avgCatchYear) # used to model future values
auto.arima(f.avgCatchYear)
plot(resid(auto.arima(avgCatchYear)))
abline(0,0)
plot(resid(auto.arima(f.avgCatchYear)))
abline(0,0)
avgCatchYear %>% forecast(h=10) %>% autoplot()
f.avgCatchYear %>% forecast(h=10) %>% autoplot()
arima.avgCY <- auto.arima(avgCatchYear) # used to model future values
arima.f.avgCY <- auto.arima(f.avgCatchYear)
arima.avgCY %>% forecast(h=10) %>% autoplot()
arima.f.avgCY %>% forecast(h=10) %>% autoplot()
map(database = "world", regions = c("USA","Canada", "Mexico","Guatemala", "Belize", "Honduras","El Salvador", "Nicaragua","Costa Rica","Panama","Colombia"), projection = 'rectangular',fill = T,col = 'grey90',parameters = 90)
points(crabData$latitude,crabData$longitude,pch=21,col='grey50',bg='gold',cex=0.7)
mapsnames <- map("world", plot = FALSE)
install.packages('lmerTest')
library(lmerTest)
install.packages('MuMIn')
library(MuMIn)
m <- lmer(haul ~ year + latitude +longitude + bottom_depth + surface_temperature + bottom_temperature + cpue + (1 | maturity), data = crabData)
summary(m)
ranef(m)
rand(m)
m <- lmer(log(haul) ~ year + latitude +longitude + bottom_depth + surface_temperature + bottom_temperature + cpue + (1 | maturity), data = crabData)
summary(m) # lat long bottom depth correlated could be problem signal -> overinterpretation
ranef(m)
rand(m)
# R2m (marginal r2) is for fixed effects
# R2c (conditional r2) is everything combined
r.squaredGLMM(m)
hist(maleData[,"cpue"])
m <- lmer(log(haul) ~ year + latitude +longitude + bottom_depth + surface_temperature + bottom_temperature + log(cpue) + (1 | maturity), data = crabData)
summary(m) # lat long bottom depth correlated could be problem signal -> overinterpretation
ranef(m)
rand(m)
# R2m (marginal r2) is for fixed effects
# R2c (conditional r2) is everything combined
r.squaredGLMM(m)
P <- lmer(log(cpue) ~ year + latitude +longitude + bottom_depth + surface_temperature + bottom_temperature + log(haul) (1 | maturity), data = crabData)
P <- lmer(log(cpue) ~ year + latitude +longitude + bottom_depth + surface_temperature + bottom_temperature + log(haul) + (1 | maturity), data = crabData)
summary(P) # lat long bottom depth correlated could be problem signal -> overinterpretation
ranef(P)
rand(P)
# R2m (marginal r2) is for fixed effects
# R2c (conditional r2) is everything combined
r.squaredGLMM(P)
m <- lmer(log(haul) ~ year + latitude +longitude + bottom_depth + surface_temperature + bottom_temperature + log(cpue) + (1 | maturity), data = crabData)
summary(m) # lat long bottom depth correlated could be problem signal -> overinterpretation
ranef(m)
rand(m)
# R2m (marginal r2) is for fixed effects
# R2c (conditional r2) is everything combined
r.squaredGLMM(m)
P <- lmer(log(cpue) ~ year + latitude +longitude + bottom_depth + surface_temperature + bottom_temperature + log(haul) + (1 | maturity), data = crabData)
summary(P) # lat long bottom depth correlated could be problem signal -> overinterpretation
ranef(P)
rand(P)
# R2m (marginal r2) is for fixed effects
# R2c (conditional r2) is everything combined
r.squaredGLMM(P)
hist(maleData[,"cpue"])
hist(maleData[,log("cpue")])
hist(log(maleData[,"cpue"])
